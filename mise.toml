[tools]
node = "20" # Pin to Node.js 20 LTS

[tasks.setup]
description = "Setup development environment (install dependencies)"
run = """
echo "Installing dependencies..."
npm install
cd workers/api && npm install && cd ../..
echo "[OK] Dependencies installed"
echo ""
echo "Next steps:"
echo "  1. Copy .env.example to .env and fill in your values"
echo "  2. Run 'mise run dev' to start development servers"
"""

[tasks.clean]
description = "Clean build artifacts and caches"
run = """
echo "Cleaning build artifacts..."
# Uncomment based on your stack:
# rm -rf node_modules dist build .next  # Node.js
# rm -rf __pycache__ *.pyc .pytest_cache  # Python
# cargo clean               # Rust
# go clean                  # Go
# rm -rf vendor             # Ruby/PHP
echo "[OK] Cleaned"
"""

[tasks.dev]
description = "Start development servers (SvelteKit + Workers)"
run = """
echo "Starting development servers..."
echo "  Frontend: http://localhost:5173"
echo "  API: http://localhost:8787"
echo ""
npm run dev
"""

[tasks.build]
description = "Build the project for production"
run = """
echo "Building project..."
npm run build
cd workers/api && npm run build && cd ../..
echo "[OK] Build complete"
"""

[tasks.run]
description = "Run the application"
run = """
# Uncomment based on your stack:
# npm start                 # Node.js
# python main.py            # Python
# cargo run                 # Rust
# go run .                  # Go
# ruby main.rb              # Ruby
# php index.php             # PHP
echo "Add 'run' command for your project"
"""

[tasks.test]
description = "Run all tests"
run = """
echo "Running tests..."
npm test
echo "[OK] Tests passed"
"""

[tasks."test:watch"]
description = "Run tests in watch mode"
run = """
# Uncomment based on your stack:
# npm run test:watch        # Node.js
# pytest-watch              # Python
# cargo watch -x test       # Rust
# go test ./... -watch      # Go (with external tool)
echo "Add 'test:watch' command for your project"
"""

[tasks."test:coverage"]
description = "Run tests with coverage report"
run = """
echo "Running tests with coverage..."
# Uncomment based on your stack:
# npm run test:coverage     # Node.js
# pytest --cov              # Python
# cargo tarpaulin           # Rust
# go test -cover ./...      # Go
# bundle exec rspec --coverage  # Ruby
echo "[OK] Coverage report generated"
"""

[tasks."test:e2e"]
description = "Run end-to-end tests"
run = """
# Uncomment based on your stack:
# npm run test:e2e          # Node.js (Playwright, Cypress)
# pytest tests/e2e          # Python
# cargo test --test e2e     # Rust
echo "Add 'test:e2e' command for your project"
"""

[tasks.format]
description = "Format code automatically"
run = """
echo "Formatting code..."
npm run format
echo "[OK] Code formatted"
"""

[tasks."format:check"]
description = "Check if code is properly formatted"
run = """
echo "Checking code format..."
# Uncomment based on your stack:
# npm run format:check      # Node.js
# black --check .           # Python
# cargo fmt -- --check      # Rust
# go fmt -l ./...           # Go
# rubocop                   # Ruby
echo "[OK] Format check passed"
"""

[tasks.lint]
description = "Run linter"
run = """
echo "Running linter..."
npm run lint
echo "[OK] Linting passed"
"""

[tasks."lint:fix"]
description = "Run linter and auto-fix issues"
run = """
# Uncomment based on your stack:
# npm run lint:fix          # Node.js
# autopep8 --in-place --recursive .  # Python
# cargo clippy --fix        # Rust
# golangci-lint run --fix   # Go
echo "Add 'lint:fix' command for your project"
"""

[tasks."type-check"]
description = "Run type checker"
run = """
# Uncomment based on your stack:
# npm run type-check        # Node.js (TypeScript)
# mypy .                    # Python
# cargo check               # Rust
# go vet ./...              # Go
echo "Add 'type-check' command for your project"
"""

[tasks.check]
description = "Run all code quality checks (format, lint, type-check)"
depends = ["format:check", "lint", "type-check"]
run = "echo '[OK] All quality checks passed'"

[tasks.validate]
description = "Run all validation checks (format, lint, type-check, test, build)"
depends = ["format:check", "lint", "type-check", "test", "build"]
run = "echo '[OK] All validation checks passed'"

[tasks.ci]
description = "Run CI pipeline (alias for validate)"
depends = ["validate"]

[tasks.docs]
description = "Generate and view documentation"
run = """
# Uncomment based on your stack:
# npm run docs              # Node.js (TypeDoc, JSDoc)
# mkdocs serve              # Python (MkDocs)
# cargo doc --open          # Rust
# godoc -http=:6060         # Go
echo "Add 'docs' command for your project"
"""

[tasks."docs:build"]
description = "Build documentation for deployment"
run = """
# Uncomment based on your stack:
# npm run docs:build        # Node.js
# mkdocs build              # Python
# cargo doc                 # Rust
echo "Add 'docs:build' command for your project"
"""

[tasks."db:migrate"]
description = "Run database migrations"
run = """
# Uncomment based on your stack:
# npm run migrate           # Node.js (Prisma, Drizzle)
# python manage.py migrate  # Django
# flask db upgrade          # Flask
# rails db:migrate          # Ruby on Rails
# php artisan migrate       # Laravel
echo "Add 'db:migrate' command for your project"
"""

[tasks."db:seed"]
description = "Seed database with sample data"
run = """
# Uncomment based on your stack:
# npm run db:seed           # Node.js
# python manage.py loaddata fixtures/*.json  # Django
# rails db:seed             # Ruby on Rails
echo "Add 'db:seed' command for your project"
"""

[tasks."db:reset"]
description = "Reset database (drop, create, migrate, seed)"
run = """
# Uncomment based on your stack:
# npm run db:reset          # Node.js
# python manage.py flush && python manage.py migrate  # Django
# rails db:reset            # Ruby on Rails
echo "Add 'db:reset' command for your project"
"""

[tasks."deps:update"]
description = "Update dependencies to latest versions"
run = """
echo "Updating dependencies..."
# Uncomment based on your stack:
# npm update                # Node.js
# pip install -U -r requirements.txt  # Python
# cargo update              # Rust
# go get -u ./...           # Go
# bundle update             # Ruby
# composer update           # PHP
echo "[OK] Dependencies updated"
"""

[tasks."deps:outdated"]
description = "Check for outdated dependencies"
run = """
# Uncomment based on your stack:
# npm outdated              # Node.js
# pip list --outdated       # Python
# cargo outdated            # Rust (requires cargo-outdated)
# go list -u -m all         # Go
# bundle outdated           # Ruby
# composer outdated         # PHP
echo "Add 'deps:outdated' command for your project"
"""

[tasks."deps:audit"]
description = "Audit dependencies for security vulnerabilities"
run = """
echo "Auditing dependencies..."
# Uncomment based on your stack:
# npm audit                 # Node.js
# pip-audit                 # Python
# cargo audit               # Rust (requires cargo-audit)
# go list -json -deps ./... | nancy sleuth  # Go (requires nancy)
echo "[OK] Audit complete"
"""

[tasks."git:hooks"]
description = "Install git hooks (husky, pre-commit, etc.)"
run = """
# Uncomment based on your setup:
# npx husky install         # Node.js (Husky)
# pre-commit install        # Python (pre-commit)
echo "Add 'git:hooks' command for your project"
"""

[tasks."docker:build"]
description = "Build Docker image"
run = """
docker build -t my-project:latest .
echo "[OK] Docker image built"
"""

[tasks."docker:run"]
description = "Run Docker container"
run = "docker run -p 3000:3000 my-project:latest"

[tasks."docker:up"]
description = "Start Docker Compose services"
run = """
docker-compose up -d
echo "[OK] Services started"
"""

[tasks."docker:down"]
description = "Stop Docker Compose services"
run = """
docker-compose down
echo "[OK] Services stopped"
"""

[tasks."docker:logs"]
description = "View Docker Compose logs"
run = "docker-compose logs -f"

[tasks.release]
description = "Create a new release (tag, build, publish)"
run = """
echo "Creating release..."
# Add your release process here
echo "[WARN] Add 'release' command for your project"
"""

[tasks.deploy]
description = "Deploy to production"
run = """
echo "Deploying to production..."
# Add your deployment process here
echo "[WARN] Add 'deploy' command for your project"
"""

[tasks.version]
description = "Show project version"
run = """
# Uncomment based on your stack:
# npm version               # Node.js
# python -c "import my-project; print(my-project.__version__)"  # Python
# cargo pkgid | cut -d# -f2 # Rust
# go version -m ./bin/app   # Go
echo "Add 'version' command for your project"
"""

[tasks.help]
description = "Show detailed help for all tasks"
run = "mise tasks ls"
